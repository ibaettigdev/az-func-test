# Input bindings are passed in via param block.
param([object] $updateListItem, $TriggerMetadata)

# Load Config from Environmental Variable
$bettercollabConfig = Get-ConfigFromEnvironment

# Write out the queue message and insertion time to the information log.
Write-Information "[Update-ListItem] :: PowerShell queue trigger function processed work item: $($updateListItem.Id)"

# Load Environmental Variable
$bettercollabConfig = Get-ConfigFromEnvironment
$bettercollabClientId = $env:clientId
$bettercollabTenantId = $env:tenantId
$bettercollabThumbprint = $env:thumbprint

#Connect PNPOnline
$listcon = Connect-PnPOnline -Url $bettercollabConfig.SPList.SiteURL -ClientId $bettercollabClientId -Tenant $bettercollabTenantId -Thumbprint $bettercollabThumbprint -ReturnConnection
$list = Get-PnPList $bettercollabConfig.SPList.Name -Connection $listcon

#Update SP List Item
Set-PNPListItem -List $list -Identity $updateListItem.Id -Values $updateListItem.itemfields -UpdateType Update -Connection $listcon | Out-Null